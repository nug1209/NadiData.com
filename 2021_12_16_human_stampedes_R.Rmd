---
title: "Human Stampedes"
output: html_notebook
---

```{r}
library(tidyverse)
```


```{r}
df <- read.csv('https://raw.githubusercontent.com/nadidata/Blog/main/2021_12_16_human_stampedes_DATASET.csv')

```


```{r}
df <- mutate(df, Date = as.Date(Date, format="%Y-%m-%d"))
df$Year <- format(df$Date, format="%Y")
df
```
```{r fig.align="center", echo=FALSE, fig.width=10}
ggplot(data=df, aes(y=Year, x=Number.of.Deaths)) + geom_bar(stat='identity')

```
```{r}
df[order(-df$Number.of.Deaths),]
```
```{r}
```


```{r}
df_sum_ctr <- df %>%
                group_by(Country) %>%
                    summarise(sum = sum(Number.of.Deaths))
```


```{r}
head(df_sum_ctr[order(-df_sum_ctr$sum),])
head(df_sum_ctr)

```

```{r}
df_sum_yr <- df %>%
                group_by(Year) %>%
                    summarise(sum = sum(Number.of.Deaths))
head(df_sum_yr[order(-df_sum_yr$sum),])
head(df_sum_yr)

```

```{r}

df_ov_500 <- df[df[,"Number.of.Deaths"]>500, ]
ggplot(data=df_ov_500, aes(y=Country, x=Number.of.Deaths)) + geom_bar(stat='identity')
# head(df_ov_500)
```
```{r}
# unique(df[c("x1")])
unique(df[c("Place")])

```
```{r}
min(df$Year)
```
```{r fig.align="center", echo=FALSE, fig.width=10}
df_count_ctr <- df %>%
                group_by(Country) %>%
                    tally()
head(df_count_ctr[order(-df_count_ctr$n),])

ggplot(data=df_count_ctr, aes(y=reorder(Country,n), x=n)) + geom_bar(stat='identity')
```
```{r fig.align="center", echo=FALSE, fig.width=10}
df_count_yr <- df %>%
                group_by(Year) %>%
                    tally()
# head(df_count_yr[order(-df_count_yr$n),])

ggplot(data=df_count_yr, aes(y=reorder(Year,n), x=n)) + geom_bar(stat='identity')
```
```{r}
df[df[,"Country"]=='Indonesia', ]
```

